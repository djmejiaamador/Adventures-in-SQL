 UPDATE auth_users
SET auth_score = auth_score +
( SELECT SUM(hub_score)
FROM hub_movies_temp h, ratings r
WHERE h.movieid = r.movieid
AND auth_users.userid = r.userid)
Where auth_users.userid in (select * from userchunk1) ;


 UPDATE auth_users
SET auth_score = auth_score +
( SELECT SUM(hub_score)
FROM hub_movies_temp h, ratings r
WHERE h.movieid = r.movieid
AND auth_users.userid = r.userid)
Where auth_users.userid in (select * from userchunk2) ;


 UPDATE auth_users
SET auth_score = auth_score +
( SELECT SUM(hub_score)
FROM hub_movies_temp h, ratings r
WHERE h.movieid = r.movieid
AND auth_users.userid = r.userid)
Where auth_users.userid in (select * from userchunk3) ;



 UPDATE auth_users
SET auth_score = auth_score +
( SELECT SUM(hub_score)
FROM hub_movies_temp h, ratings r
WHERE h.movieid = r.movieid
AND auth_users.userid = r.userid)
Where auth_users.userid in (select * from userchunk4) ;


 UPDATE auth_users
SET auth_score = auth_score +
( SELECT SUM(hub_score)
FROM hub_movies_temp h, ratings r
WHERE h.movieid = r.movieid
AND auth_users.userid = r.userid)
Where auth_users.userid in (select * from userchunk5) ;



 UPDATE auth_users
SET auth_score = auth_score +
( SELECT SUM(hub_score)
FROM hub_movies_temp h, ratings r
WHERE h.movieid = r.movieid
AND auth_users.userid = r.userid)
Where auth_users.userid in (select * from userchunk6) ;



 UPDATE auth_users
SET auth_score = auth_score +
( SELECT SUM(hub_score)
FROM hub_movies_temp h, ratings r
WHERE h.movieid = r.movieid
AND auth_users.userid = r.userid)
Where auth_users.userid in (select * from userchunk7) ;

       
 UPDATE auth_users
SET auth_score = auth_score +
( SELECT SUM(hub_score)
FROM hub_movies_temp h, ratings r
WHERE h.movieid = r.movieid
AND auth_users.userid = r.userid)
Where auth_users.userid in (select * from userchunk8) ;


 UPDATE auth_users
SET auth_score = auth_score +
( SELECT SUM(hub_score)
FROM hub_movies_temp h, ratings r
WHERE h.movieid = r.movieid
AND auth_users.userid = r.userid)
Where auth_users.userid in (select * from userchunk9) ;


 UPDATE auth_users
SET auth_score = auth_score +
( SELECT SUM(hub_score)
FROM hub_movies_temp h, ratings r
WHERE h.movieid = r.movieid
AND auth_users.userid = r.userid)
Where auth_users.userid in (select * from userchunk10) ;


 UPDATE auth_users
SET auth_score = auth_score +
( SELECT SUM(hub_score)
FROM hub_movies_temp h, ratings r
WHERE h.movieid = r.movieid
AND auth_users.userid = r.userid)
Where auth_users.userid in (select * from userchunk11) ;


 UPDATE auth_users
SET auth_score = auth_score +
( SELECT SUM(hub_score)
FROM hub_movies_temp h, ratings r
WHERE h.movieid = r.movieid
AND auth_users.userid = r.userid)
Where auth_users.userid in (select * from userchunk12) ;

 UPDATE auth_users
SET auth_score = auth_score +
( SELECT SUM(hub_score)
FROM hub_movies_temp h, ratings r
WHERE h.movieid = r.movieid
AND auth_users.userid = r.userid)
Where auth_users.userid in (select * from userchunk13) ;


explain analyze UPDATE auth_users
SET auth_score = auth_score +
( SELECT SUM(hub_score)
FROM hub_movies_temp h, ratings r
WHERE h.movieid = r.movieid
AND auth_users.userid = r.userid)
Where auth_users.userid in (select * from userchunk14) ;

 UPDATE auth_users
SET auth_score = auth_score +
( SELECT SUM(hub_score)
FROM hub_movies_temp h, ratings r
WHERE h.movieid = r.movieid
AND auth_users.userid = r.userid)
Where auth_users.userid in (select * from userchunk15) ;


 UPDATE auth_users
SET auth_score = auth_score +
( SELECT SUM(hub_score)
FROM hub_movies_temp h, ratings r
WHERE h.movieid = r.movieid
AND auth_users.userid = r.userid)
Where auth_users.userid in (select * from userchunk16) ;


 UPDATE auth_users
SET auth_score = auth_score +
( SELECT SUM(hub_score)
FROM hub_movies_temp h, ratings r
WHERE h.movieid = r.movieid
AND auth_users.userid = r.userid)
Where auth_users.userid in (select * from userchunk17) ;


 UPDATE auth_users
SET auth_score = auth_score +
( SELECT SUM(hub_score)
FROM hub_movies_temp h, ratings r
WHERE h.movieid = r.movieid
AND auth_users.userid = r.userid)
Where auth_users.userid in (select * from userchunk18) ;


 UPDATE auth_users
SET auth_score = auth_score +
( SELECT SUM(hub_score)
FROM hub_movies_temp h, ratings r
WHERE h.movieid = r.movieid
AND auth_users.userid = r.userid)
Where auth_users.userid in (select * from userchunk19) ;

 UPDATE auth_users
SET auth_score = auth_score +
( SELECT SUM(hub_score)
FROM hub_movies_temp h, ratings r
WHERE h.movieid = r.movieid
AND auth_users.userid = r.userid)
Where auth_users.userid in (select * from userchunk20) ;


 UPDATE auth_users
SET auth_score = auth_score +
( SELECT SUM(hub_score)
FROM hub_movies_temp h, ratings r
WHERE h.movieid = r.movieid
AND auth_users.userid = r.userid)
Where auth_users.userid in (select * from userchunk21) ;


 UPDATE auth_users
SET auth_score = auth_score +
( SELECT SUM(hub_score)
FROM hub_movies_temp h, ratings r
WHERE h.movieid = r.movieid
AND auth_users.userid = r.userid)
Where auth_users.userid in (select * from userchunk22) ;



 UPDATE auth_users
SET auth_score = auth_score +
( SELECT SUM(hub_score)
FROM hub_movies_temp h, ratings r
WHERE h.movieid = r.movieid
AND auth_users.userid = r.userid)
Where auth_users.userid in (select * from userchunk23) ;


 UPDATE auth_users
SET auth_score = auth_score +
( SELECT SUM(hub_score)
FROM hub_movies_temp h, ratings r
WHERE h.movieid = r.movieid
AND auth_users.userid = r.userid)
Where auth_users.userid in (select * from userchunk24) ;


 UPDATE auth_users
SET auth_score = auth_score +
( SELECT SUM(hub_score)
FROM hub_movies_temp h, ratings r
WHERE h.movieid = r.movieid
AND auth_users.userid = r.userid)
Where auth_users.userid in (select * from userchunk25) ;


 UPDATE auth_users
SET auth_score = auth_score +
( SELECT SUM(hub_score)
FROM hub_movies_temp h, ratings r
WHERE h.movieid = r.movieid
AND auth_users.userid = r.userid)
Where auth_users.userid in (select * from userchunk26) ;


 UPDATE auth_users
SET auth_score = auth_score +
( SELECT SUM(hub_score)
FROM hub_movies_temp h, ratings r
WHERE h.movieid = r.movieid
AND auth_users.userid = r.userid)
Where auth_users.userid in (select * from userchunk27) ;

 UPDATE auth_users
SET auth_score = auth_score +
( SELECT SUM(hub_score)
FROM hub_movies_temp h, ratings r
WHERE h.movieid = r.movieid
AND auth_users.userid = r.userid)
Where auth_users.userid in (select * from userchunk28) ;

 UPDATE auth_users
SET auth_score = auth_score +
( SELECT SUM(hub_score)
FROM hub_movies_temp h, ratings r
WHERE h.movieid = r.movieid
AND auth_users.userid = r.userid)
Where auth_users.userid in (select * from userchunk29) ;


 UPDATE auth_users
SET auth_score = auth_score +
( SELECT SUM(hub_score)
FROM hub_movies_temp h, ratings r
WHERE h.movieid = r.movieid
AND auth_users.userid = r.userid)
Where auth_users.userid in (select * from userchunk30) ;


 UPDATE auth_users
SET auth_score = auth_score +
( SELECT SUM(hub_score)
FROM hub_movies_temp h, ratings r
WHERE h.movieid = r.movieid
AND auth_users.userid = r.userid)
Where auth_users.userid in (select * from userchunk31) ;



 UPDATE auth_users
SET auth_score = auth_score +
( SELECT SUM(hub_score)
FROM hub_movies_temp h, ratings r
WHERE h.movieid = r.movieid
AND auth_users.userid = r.userid)
Where auth_users.userid in (select * from userchunk32) ;


 UPDATE auth_users
SET auth_score = auth_score +
( SELECT SUM(hub_score)
FROM hub_movies_temp h, ratings r
WHERE h.movieid = r.movieid
AND auth_users.userid = r.userid)
Where auth_users.userid in (select * from userchunk33) ;


 UPDATE auth_users
SET auth_score = auth_score +
( SELECT SUM(hub_score)
FROM hub_movies_temp h, ratings r
WHERE h.movieid = r.movieid
AND auth_users.userid = r.userid)
Where auth_users.userid in (select * from userchunk34) ;



-- normalize  1
explain analyze update norms
set norm = (
SELECT SQRT( SUM(auth_score*auth_score ) )
FROM auth_users )
where table_name = 'auth_users';

        -- apply norm 8
        explain analyze UPDATE auth_users
        SET auth_score = auth_score / 
        ( select norm from norms
        where table_name = 'auth_users');